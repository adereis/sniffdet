.\" SPDX-License-Identifier: GPL-2.0-or-later
.TH SNIFFDET.CONF 5 2025-12-21 "sniffdet 0.10" "File Formats"
.SH NAME
sniffdet.conf \- configuration file for sniffdet
.SH DESCRIPTION
.B sniffdet.conf
configures the behavior of
.BR sniffdet (1),
including test parameters, logging, and plugin settings.
.PP
The configuration file is searched in the following order:
.IP 1. 4
.I ~/.config/sniffdet/sniffdet.conf
(user configuration)
.IP 2. 4
.I /etc/sniffdet.conf
(system-wide configuration)
.SH SYNTAX
The configuration file uses a simple block-based syntax:
.IP \(bu 2
Sections are delimited by braces
.BR { " and " } .
.IP \(bu 2
Variables are assigned with
.BR = .
.IP \(bu 2
Comments start with
.B #
and continue to end of line.
.IP \(bu 2
Blank lines are ignored.
.SH SECTIONS
.SS global
General settings that apply to all tests.
.TP
.BI verbose " = 0|1"
Enable verbose output.
.TP
.BI logtype " = FILE|STDOUT|STDERR|SYSLOG"
Log destination (can be combined).
.TP
.BI logfile " = " path
Log file path when using FILE.
.TP
.BI plugin " = " filename
Output plugin to use (e.g., "stdout.so", "xml.so").
.TP
.BI plugins_dir " = " directory
Directory to search for plugins.
.TP
.BI UID " = " number
User ID to run as after dropping root privileges.
.TP
.BI GID " = " number
Group ID to run as after dropping root privileges.
.TP
.BI iface " = " device
Default network interface.
.TP
.BI fake_hwaddr " = {" "0xNN, 0xNN, ..." }
Fake MAC address for tests.
.TP
.BI fake_ipaddr " = " address
Fake IP address for tests.
.SS icmptest
Settings for the ICMP detection test.
.TP
.BI timeout " = " seconds
Test timeout.
.TP
.BI tries " = " number
Number of probe attempts.
.TP
.BI interval " = " milliseconds
Interval between probes.
.TP
.BI fake_hwaddr " = {" "0xNN, ..." }
Fake MAC address for this test.
.SS arptest
Settings for the ARP detection test.
Same options as
.BR icmptest .
.SS dnstest
Settings for the DNS detection test.
.TP
.BI timeout ", " tries ", " interval
Same as other tests.
.TP
.BI fake_ipaddr " = " address
Source IP for bogus packets.
.TP
.BI fake_hwaddr " = {" "0xNN, ..." }
Source MAC for bogus packets.
.TP
.BI sport " = " port
Source port for bogus traffic.
.TP
.BI dport " = " port
Destination port for bogus traffic.
.SS latencytest
Settings for the latency detection test.
.TP
.BI timeout " = " seconds
Test timeout.
.TP
.BI interval " = " milliseconds
Interval between probes.
.TP
.BI tcpflags " = SYN|FIN|RST|ACK|PUSH|URG"
TCP flags for probe packets.
.SS plugins
Plugin-specific configuration.
.TP
.BI xmlplugin_filename " = " path
Output file for XML plugin.
.SH EXAMPLE
.nf
# Global configuration
global {
    verbose = 0;
    logtype = FILE;
    logfile = "sniffdet.log";
    plugin = "stdout.so";
    UID = 1000;
    GID = 1000;
    iface = "eth0";
    fake_hwaddr = {0xff, 0x00, 0x00, 0x00, 0x00, 0x00};
    fake_ipaddr = "192.168.1.100";
}

# ICMP test settings
icmptest {
    timeout = 20;
    tries = 10;
    interval = 1000;
    fake_hwaddr = {0xff, 0x00, 0x00, 0x00, 0x00, 0x00};
}

# DNS test settings
dnstest {
    timeout = 20;
    tries = 10;
    interval = 1000;
    fake_ipaddr = "10.0.0.10";
    fake_hwaddr = {0x46, 0x0f, 0xA4, 0x33, 0x11, 0xD1};
    sport = 22;
    dport = 22;
}

# Latency test settings
latencytest {
    timeout = 300;
    interval = 1500;
    tcpflags = SYN;
}

# Plugin options
plugins {
    xmlplugin_filename = "sniffdet-output.xml";
}
.fi
.SH NOTES
Using randomized fake addresses makes detection tests less
identifiable by sniffers that specifically look for sniffdet traffic.
.PP
The default values shown above are examples only.
Configure appropriate values for your environment.
.SH BUGS
The configuration parser has limited error reporting.
Check the log file if sniffdet fails to start.
.PP
Report bugs at https://github.com/adereis/sniffdet/issues
.SH AUTHORS
Ademar de Souza Reis Jr.
.RI < ademar@ademar.org >
.br
Milton Soares Filho
.RI < eu_mil@yahoo.com >
.SH SEE ALSO
.BR sniffdet (1),
.BR libsniffdet (3)
