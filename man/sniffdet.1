.\" SPDX-License-Identifier: GPL-2.0-or-later
.TH SNIFFDET 1 2025-12-21 "sniffdet 0.10" "User Commands"
.SH NAME
sniffdet \- remote sniffer detection tool
.SH SYNOPSIS
.B sniffdet
.RI [ options ]
.I target
.SH DESCRIPTION
.B sniffdet
detects machines running in promiscuous mode (i.e., sniffing network traffic)
using various network-based tests.
It implements techniques from academic research on remote sniffer detection
in TCP/IP environments.
.PP
The tool supports multiple detection tests that can be run individually or
combined, with configurable parameters via command-line options or a
configuration file.
.SH OPTIONS
.I target
is a hostname or IPv4 address in dotted-decimal notation.
.TP
.BR \-i ", " \-\-iface =\fIdevice\fR
Use network
.I device
for tests.
Default is the first available interface.
.TP
.BR \-l ", " \-\-log =\fIfile\fR
Write test log to
.IR file .
Default is no logging.
.TP
.BR \-c ", " \-\-configfile =\fIfile\fR
Read configuration from
.IR file .
Default is
.IR /etc/sniffdet.conf ,
with fallback to
.IR ~/.config/sniffdet/sniffdet.conf .
.TP
.BR \-f ", " \-\-hostsfile =\fIfile\fR
Read target hosts from
.IR file ,
one hostname or IP address per line.
Lines starting with
.B #
are treated as comments.
.TP
.BR \-u ", " \-\-uid =\fIuid\fR
Run as
.I uid
after dropping root privileges.
Default is 280 (configurable).
.TP
.BR \-g ", " \-\-gid =\fIgid\fR
Run as
.I gid
after dropping root privileges.
Default is 280 (configurable).
.TP
.BR \-t ", " \-\-test =\fItest\fR[,\fItest\fR...]
Run specific detection test(s).
Multiple tests can be specified as a comma-separated list.
Available tests:
.RS
.TP
.B dns
DNS test \- triggers reverse DNS lookups on sniffing hosts.
.TP
.B arp
ARP test \- exploits promiscuous mode ARP handling.
.TP
.B icmp
ICMP test \- sends pings with fake MAC addresses.
.TP
.B latency
Latency test \- measures response time changes under load.
.RE
.TP
.BI \-\-pluginsdir= directory
Load plugins from
.IR directory .
.TP
.BR \-p ", " \-\-plugin =\fIname\fR
Use output plugin
.I name
(e.g., xml, stdout).
.TP
.BR \-v ", " \-\-verbose
Enable verbose output.
.TP
.BR \-s ", " \-\-silent
Suppress all output messages.
.TP
.BR \-h ", " \-\-help
Display help and exit.
.TP
.B \-\-version
Display version information and exit.
.SH EXAMPLES
Test a host using DNS, ARP, and ICMP tests on a specific interface:
.PP
.RS
.EX
sniffdet \-i enp0s3 \-t dns,arp,icmp 192.168.1.100
.EE
.RE
.PP
Run latency test with XML output:
.PP
.RS
.EX
sniffdet \-t latency \-\-plugin=xml target.example.com
.EE
.RE
.PP
Scan multiple hosts from a file:
.PP
.RS
.EX
sniffdet \-f targets.txt \-t icmp
.EE
.RE
.SH FILES
.TP
.I /etc/sniffdet.conf
System-wide configuration file.
.TP
.I ~/.config/sniffdet/sniffdet.conf
User configuration file (takes precedence).
.SH EXIT STATUS
.TP
.B 0
Success.
.TP
.B non-zero
An error occurred.
.SH NOTES
This tool requires root privileges or appropriate capabilities
.RB ( CAP_NET_RAW ", " CAP_NET_ADMIN )
to send raw packets and capture network traffic.
.PP
The effectiveness of detection tests depends on the target's network stack
implementation and may produce false positives or negatives.
.SH BUGS
Report bugs at https://github.com/adereis/sniffdet/issues
.SH AUTHORS
Ademar de Souza Reis Jr.
.RI < ademar@ademar.org >
.br
Milton Soares Filho
.RI < eu_mil@yahoo.com >
.SH SEE ALSO
.BR sniffdet.conf (5),
.BR libsniffdet (3),
.BR tcpdump (1),
.BR wireshark (1)
